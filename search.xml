<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>scrapy 将str类型 html字符串，转为scrapy的response对象</title>
      <link href="2021/04/16/scrapy-%E5%B0%86str%E7%B1%BB%E5%9E%8B-html%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%E8%BD%AC%E4%B8%BAscrapy%E7%9A%84response%E5%AF%B9%E8%B1%A1/"/>
      <url>2021/04/16/scrapy-%E5%B0%86str%E7%B1%BB%E5%9E%8B-html%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%E8%BD%AC%E4%B8%BAscrapy%E7%9A%84response%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<h3 id="以下内容为，如何将str类型的-html文本转为-scrapy的response对象"><a href="#以下内容为，如何将str类型的-html文本转为-scrapy的response对象" class="headerlink" title="以下内容为，如何将str类型的 html文本转为 scrapy的response对象"></a>以下内容为，如何将str类型的 html文本转为 scrapy的response对象</h3><blockquote><p>这么做的好处是, 转为scrapy自身的response对象,<br>就可以使用response.css(),<br>就可以使用response.xpath(),<br>就可以使用response.json(),<br>等方法, 当然你也可以使用 lxml 进行处理, 我这里是为了方便统一大量的爬虫书写规范</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>http <span class="token keyword">import</span> HtmlResponse<span class="token comment"># content为待转换的html文本，如：'&lt;p>balabalbablabla&lt;/p>'</span>html <span class="token operator">=</span> HtmlResponse<span class="token punctuation">(</span>            url<span class="token operator">=</span>response<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token comment"># 设置一个url, 推荐当前使用方式</span>            body<span class="token operator">=</span>content<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token comment"># 选择编码格式</span>        <span class="token punctuation">)</span><span class="token comment"># 现在 html 就是我们转换后的 response类型对象, 可以进行 html.css(), html.xpath()等操作了</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Scrapy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> scrapy对象的使用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scrapy 的POST请求</title>
      <link href="2021/04/16/scrapy-%E7%9A%84POST%E8%AF%B7%E6%B1%82/"/>
      <url>2021/04/16/scrapy-%E7%9A%84POST%E8%AF%B7%E6%B1%82/</url>
      
        <content type="html"><![CDATA[<h2 id="scrapy构造POST的两种方式"><a href="#scrapy构造POST的两种方式" class="headerlink" title="scrapy构造POST的两种方式"></a>scrapy构造POST的两种方式</h2><h3 id="scrapy-FormRequest"><a href="#scrapy-FormRequest" class="headerlink" title="scrapy.FormRequest"></a>scrapy.FormRequest</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">yeild scrapy<span class="token punctuation">.</span>FormRequest<span class="token punctuation">(</span>    url<span class="token operator">=</span><span class="token string">'https://........'</span><span class="token punctuation">,</span>     method<span class="token operator">=</span><span class="token string">'post'</span><span class="token punctuation">,</span>  <span class="token comment"># 选择post</span>    dont_filter<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token comment"># 关闭去重, 非必须</span>    formdata<span class="token operator">=</span>data<span class="token punctuation">,</span> <span class="token comment"># post 数据根据情况 选择是  dict类型: data / json字符串类型: json.dumps(data)</span>    callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="scrapy-Request"><a href="#scrapy-Request" class="headerlink" title="scrapy.Request"></a>scrapy.Request</h3><blockquote><p>跟我们平时用get请求的方法一样</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>        method<span class="token operator">=</span><span class="token string">'POST'</span><span class="token punctuation">,</span><span class="token comment"># 选择post</span>        url<span class="token operator">=</span><span class="token string">'https://...'</span><span class="token punctuation">,</span>         body<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 注意这里的key: body 就是指你需要请求的post data, 同样post 数据根据情况 选择是  dict类型: data / json字符串类型: json.dumps(data)</span>        headers<span class="token operator">=</span>self<span class="token punctuation">.</span>headers<span class="token punctuation">,</span> <span class="token comment"># dict 类型</span>        callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Scrapy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> scrapy请求方式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python list格式的str, 转换成list类型</title>
      <link href="2021/04/16/python-list%E6%A0%BC%E5%BC%8F%E7%9A%84str-%E8%BD%AC%E6%8D%A2%E6%88%90list%E7%B1%BB%E5%9E%8B/"/>
      <url>2021/04/16/python-list%E6%A0%BC%E5%BC%8F%E7%9A%84str-%E8%BD%AC%E6%8D%A2%E6%88%90list%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="今天遇到一个list格式的str，我想重新转回list类型"><a href="#今天遇到一个list格式的str，我想重新转回list类型" class="headerlink" title="今天遇到一个list格式的str，我想重新转回list类型"></a>今天遇到一个list格式的str，我想重新转回list类型</h2><blockquote><p>待转换目标：</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">172</span><span class="token punctuation">]</span><span class="token punctuation">:</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'"TemplateId":(.*?),'</span><span class="token punctuation">,</span>rsp<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>Out<span class="token punctuation">[</span><span class="token number">172</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'["&#123;652B0562-7D75-46D2-A6A6-C63CF833AE3A&#125;"]'</span>In <span class="token punctuation">[</span><span class="token number">173</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">type</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'"TemplateId":(.*?),'</span><span class="token punctuation">,</span>rsp<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">173</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="首先想到的是-list-方法-结果"><a href="#首先想到的是-list-方法-结果" class="headerlink" title="首先想到的是 list() 方法, 结果"></a>首先想到的是 list() 方法, 结果</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">174</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'"TemplateId":(.*?),'</span><span class="token punctuation">,</span>rsp<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">174</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'['</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'&#123;'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>很明显, 这不是我想要的结果</p></blockquote><h3 id="最后借助-json-loads-成功转换"><a href="#最后借助-json-loads-成功转换" class="headerlink" title="最后借助 json.loads 成功转换"></a>最后借助 json.loads 成功转换</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">175</span><span class="token punctuation">]</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'"TemplateId":(.*?),'</span><span class="token punctuation">,</span>rsp<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">175</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'&#123;652B0562-7D75-46D2-A6A6-C63CF833AE3A&#125;'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串处理 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scrapy 重定向解决</title>
      <link href="2021/04/15/scrapy-%E9%87%8D%E5%AE%9A%E5%90%91%E8%A7%A3%E5%86%B3/"/>
      <url>2021/04/15/scrapy-%E9%87%8D%E5%AE%9A%E5%90%91%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<h2 id="只需要在每次构造请求前-在meta中添加如下信息即可-settings中如果有默认user-agent，又非本次请求的网站头也建议注释掉"><a href="#只需要在每次构造请求前-在meta中添加如下信息即可-settings中如果有默认user-agent，又非本次请求的网站头也建议注释掉" class="headerlink" title="只需要在每次构造请求前, 在meta中添加如下信息即可,settings中如果有默认user-agent，又非本次请求的网站头也建议注释掉"></a>只需要在每次构造请求前, 在meta中添加如下信息即可,settings中如果有默认user-agent，又非本次请求的网站头也建议注释掉</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>    url<span class="token punctuation">,</span>     callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse<span class="token punctuation">,</span>     dont_filter<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token comment"># Scrapy是默认过滤掉重复的请求URL, 关闭它</span>    meta<span class="token operator">=</span><span class="token punctuation">&#123;</span>         <span class="token string">'dont_redirect'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token comment"># 关闭重定向</span>        <span class="token string">'handle_httpstatus_list'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">301</span><span class="token punctuation">,</span><span class="token number">302</span><span class="token punctuation">]</span> <span class="token comment"># 接受的响应 code</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Scrapy </tag>
            
            <tag> 重定向 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用hexo搭建博客，并配置主题</title>
      <link href="2021/04/12/%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%EF%BC%8C%E5%B9%B6%E9%85%8D%E7%BD%AE%E4%B8%BB%E9%A2%98/"/>
      <url>2021/04/12/%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%EF%BC%8C%E5%B9%B6%E9%85%8D%E7%BD%AE%E4%B8%BB%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><blockquote><p>安装以下内容所需环境：npm，git</p></blockquote><ol><li><p>hexo</p></li><li><p>hexo-theme-argon</p></li><li><p><a href="https://hexo.bootcss.com/docs/index.html">安装hexo文档</a></p><blockquote><p>hexo 安装后进入你安装的目录/themes下，下载主题</p></blockquote></li><li><p>下载主题，<a href="https://github.com/solstice23/hexo-theme-argon">主题地址</a></p> <pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 在 你的目录&#x2F;themes 下进行clone    1. git clone https:&#x2F;&#x2F;github.com&#x2F;solstice23&#x2F;hexo-theme-argon.git    2. 将下载的主题更名为：argon<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>配置主题相关修改</p> <pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 在 Hexo 你的目录&#x2F;_config.yml 中将 theme 项改为 argon# 将 Hexo 你的目录&#x2F;themes&#x2F;argon&#x2F;_config.yml 复制到 ，你的目录&#x2F;source&#x2F;_data（没有则自建） 文件夹中，并重命名为 argon.yml# 在 你的目录&#x2F;themes 下操作    1. npm install hexo-generator-search --save# 在 Hexo 你的目录&#x2F;_config.yml 下操作    注意缩进    1. search:          path: search.xml          field: post          content: true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>启动即可预览</p> <pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 在 你的目录&#x2F; 下操作hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol>]]></content>
      
      
      <categories>
          
          <category> 个人 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> themes </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
